{
  "title": "Windows Shell File Write to Suspicious Folder",
  "id": "1277f594-a7d1-4f28-a2d3-73af5cbeab43",
  "status": "experimental",
  "description": "Detects a Windows executable that writes files to suspicious folders",
  "references": ["Internal Research"],
  "author": "Florian Roth",
  "date": "2021/11/20",
  "modified": "2022/07/14",
  "logsource": {
    "category": "file_event",
    "product": "windows"
  },
  "detection": {
    "selection_shells": {
      "Image|endswith": [
        "\\cmd.exe",
        "\\powershell.exe",
        "\\pwsh.exe",
        "\\wscript.exe",
        "\\cscript.exe",
        "\\sh.exe",
        "\\bash.exe",
        "\\msbuild.exe",
        "\\certutil.exe"
      ],
      "TargetFilename|contains": ["C:\\Users\\Public", "C:\\PerfLogs"]
    },
    "selection_program": {
      "Image|endswith": [
        "\\schtasks.exe",
        "\\wmic.exe",
        "\\mshta.exe",
        "\\forfiles.exe",
        "\\scriptrunner.exe",
        "\\certutil.exe"
      ],
      "TargetFilename|contains": [
        "C:\\Users\\Public",
        "C:\\PerfLogs",
        "\\AppData\\",
        "C:\\Windows\\Temp"
      ]
    },
    "condition": "1 of selection*"
  },
  "fields": ["CommandLine", "ParentCommandLine"],
  "falsepositives": ["Unknown"],
  "level": "high"
}
